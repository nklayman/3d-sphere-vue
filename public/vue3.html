<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>3D Sphere Vue 3</title>
  </head>
  <body>
    <div id="app"></div>
    <script src="https://threejs.org/build/three.js"></script>
    <script type="module">
      import { WebGlHelper } from './WebGl.js'
      import { createApp } from './vue.js'
      const random = () => Math.random() * 360
      const getRotations = (num = 20) =>
        Array(num)
          .fill()
          .map(() => [random(), random(), random()])
      const MyComponent = {
        template: `<p class="info">FPS: {{ fps }}</p>
      <div class="controls">
        Amount
        <select @change="updateCount">
          <option value="20" selected>20</option>
          <option value="100">100</option>
          <option value="200">200</option>
          <option value="500">500</option>
          <option value="1000">1000</option>
          <option value="2000">2000</option>
          <option value="5000">5000</option>
          <option value="10000">10000</option>
        </select>
      </div>
      <a class="repo" href="https://github.com/nklayman/3d-sphere-vue">
        https://github.com/nklayman/3d-sphere-vue
      </a>
      <main ref="element"></main>`,
        name: 'SphereVue',
        data: () => ({
          fps: 0,
          count: 20,
          rotations: getRotations()
        }),
        mounted() {
          const { element } = this.$refs
          this.renderer = new WebGlHelper({
            container: element,
            onFPSUpdate: fps => (this.fps = fps)
          })

          this.renderer.animate()
          this.renderer.syncBoxes(this.rotations)
        },
        methods: {
          updateCount(event) {
            this.count = event.target.value
            this.rotations = getRotations(Number(this.count))
            this.renderer.syncBoxes(this.rotations)
          }
        }
      }
      const app = createApp().mount(MyComponent, '#app')
    </script>
  </body>
</html>
